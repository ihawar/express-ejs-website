<div class="overflow-auto flex flex-col h-full">
    <section class="flex flex-col md:flex-row w-full justify-between gap-2 md:gap-24">
        <div class="flex-1 bg-linear-to-br rounded-2xl md:rounded-3xl
        from-white to-primary-light/30 border-2 border-primary-light
        px-6 py-2 md:px-8 md:py-8 gap-4 md:gap-12 flex flex-col justify-between">
            <h3 class="text-primary text-xl md:text-3xl font-bold">درخواست های رزرو</h3>
            <p class="text-primary text-4xl md:text-6xl font-black text-left w-full"><%= reservationCount %></p>
        </div>

        <div class="flex-1 bg-linear-to-br rounded-2xl md:rounded-3xl
        from-white to-primary-light/30 border-2 border-primary-light
         px-6 py-2 md:px-8 md:py-8 gap-4 md:gap-12 flex flex-col justify-between">
            <h3 class="text-primary text-xl md:text-3xl font-bold">بازدید های وبسایت</h3>
            <p class="text-primary text-4xl md:text-6xl font-black text-left w-full"><%= visitsCount %></p>
        </div>
    </section>

    <section class="bg-gray-100 overflow-auto 
    w-full mt-2 md:mt-8 h-full rounded-2xl md:rounded-3xl p-2 md:p-8">

        <!-- Filters -->
        <div class="flex flex-col gap-4 
        md:flex-row md:items-center md:justify-between">
            <input
            type="text"
            name="q"
            value="<%= filters.q %>"
            placeholder="جستجو نام بیمار..."
            class="w-full md:w-1/3 rounded-xl border px-4 py-2"
            />
            <div class="flex gap-4 justify-between">
                <select name="time" class="rounded-xl text-gray-600 border px-4 py-2">
                <option value="day" <%= filters.time === 'day' ? 'selected' : '' %>>۱ روز گذشته</option>
                <option value="3days" <%= filters.time === '3days' ? 'selected' : '' %>>۳ روز گذشته</option>
                <option value="week" <%= filters.time === 'week' ? 'selected' : '' %>>هفته گذشته</option>
                <option value="month" <%= filters.time === 'month' ? 'selected' : '' %>>ماه گذشته</option>
                <option value="all" <%= filters.time === 'all' ? 'selected' : '' %>>تمام دوران</option>
                </select>

                <select name="status" class="rounded-xl text-gray-600 border px-4 py-2">
                <option value="all" <%= filters.status === 'all' ? 'selected' : '' %>>همه وضعیت‌ها</option>
                <option value="PENDING" <%= filters.status === 'PENDING' ? 'selected' : '' %>>بررسی نشده</option>
                <option value="ACCEPTED" <%= filters.status === 'ACCEPTED' ? 'selected' : '' %>>تایید شده</option>
                <option value="DECLINED" <%= filters.status === 'DECLINED' ? 'selected' : '' %>>رد شده</option>
                </select>
            </div>
        </div>

        <!-- List -->
        <div class="mt-6 space-y-3">
        <% if (reservations.length === 0) { %>
            <div class="text-center text-gray-500 py-8">
            موردی یافت نشد
            </div>
        <% } %>

        <% reservations.forEach(r => { %>
            <a
            href="/admin/reservation/<%= r.id %>"
            target="_blank"
            class="bg-white rounded-xl px-2 md:px-8 py-4
            flex justify-between items-center hover:bg-gray-50">

            <div class="flex-1">
                <div class="font-medium text-gray-700 text-lg"><%= r.fullname %></div>
                <div class="text-sm text-gray-500">
                <%= new Date(r.created_at * 1000).toLocaleDateString('fa-IR') %>
                </div>
            </div>

            <p class="hidden md:block flex-1 text-lg text-gray-600 font-semibold"><%= r.phone %></p>

            <span class="flex-1 text-center
                text-sm px-3 py-1 rounded-full border
                <%= r.status === 'PENDING' ? 'text-blue-600' : '' %>
                <%= r.status === 'ACCEPTED' ? 'text-green-600' : '' %>
                <%= r.status === 'DECLINED' ? 'text-red-600' : '' %>
            ">
                <%= r.status === 'PENDING' ? 'بررسی نشده' : '' %>
                <%= r.status === 'ACCEPTED' ? 'تایید شده' : '' %>
                <%= r.status === 'DECLINED' ? 'رد شده' : '' %>
            </span>

            </a>
        <% }) %>
        </div>

        <!-- Pagination -->
        <div class="flex justify-center gap-4 mt-6 text-gray-600 font-medium">

        <% if (pagination.currentPage > 1) { %>
            <a
            href="?<%= new URLSearchParams({
                ...filters,
                page: pagination.currentPage - 1
            }).toString() %>"
            class="px-4 py-2 rounded-xl border"
            >
            قبلی
            </a>
        <% } %>

        <% if (pagination.currentPage < pagination.totalPages) { %>
            <a
            href="?<%= new URLSearchParams({
                ...filters,
                page: pagination.currentPage + 1
            }).toString() %>"
            class="px-4 py-2 rounded-xl border"
            >
            بعدی
            </a>
        <% } %>

        </div>


    </section>

</div>

<script type="module" src="/statics/js/reservationList.js"></script>
